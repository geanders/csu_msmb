<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.7.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Sherry WeMott">

  
  
  
    
  
  <meta name="description" content="Exercise 1.8 (p. 17) Is the mitochondrial sequence of C. elegans consistent with a model of equally likely nucleotides?
 This exercise asks us to explore the frequency of each of the four nucleotides (A, C, G, and T) in the genome of C. elegans, a type of worm used frequently in scientific research.
This solution requires that several R extension packages be loaded in your R session. If you do not have these packages installed to your computer yet, you should follow instructions we’ve posted separately describing the required set-up for this exercise.">

  
  <link rel="alternate" hreflang="en-us" href="/post/exercise-solution-for-chapter-1/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36719749-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           document.location = url;
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target);  
  }

  gtag('js', new Date());
  gtag('config', 'UA-36719749-3', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/post/exercise-solution-for-chapter-1/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="CSU MSMB Group Study">
  <meta property="og:url" content="/post/exercise-solution-for-chapter-1/">
  <meta property="og:title" content="Exercise solution for Chapter 1 | CSU MSMB Group Study">
  <meta property="og:description" content="Exercise 1.8 (p. 17) Is the mitochondrial sequence of C. elegans consistent with a model of equally likely nucleotides?
 This exercise asks us to explore the frequency of each of the four nucleotides (A, C, G, and T) in the genome of C. elegans, a type of worm used frequently in scientific research.
This solution requires that several R extension packages be loaded in your R session. If you do not have these packages installed to your computer yet, you should follow instructions we’ve posted separately describing the required set-up for this exercise."><meta property="og:image" content="img/map[gravatar:%!s(bool=false) shape:circle]">
  <meta property="twitter:image" content="img/map[gravatar:%!s(bool=false) shape:circle]"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-02-11T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-02-11T20:22:07-07:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/exercise-solution-for-chapter-1/"
  },
  "headline": "Exercise solution for Chapter 1",
  
  "datePublished": "2020-02-11T00:00:00Z",
  "dateModified": "2020-02-11T20:22:07-07:00",
  
  "author": {
    "@type": "Person",
    "name": "Brooke Anderson"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "CSU MSMB Group Study",
    "logo": {
      "@type": "ImageObject",
      "url": "img//"
    }
  },
  "description": "Exercise 1.8 (p. 17) Is the mitochondrial sequence of C. elegans consistent with a model of equally likely nucleotides?\n This exercise asks us to explore the frequency of each of the four nucleotides (A, C, G, and T) in the genome of C. elegans, a type of worm used frequently in scientific research.\nThis solution requires that several R extension packages be loaded in your R session. If you do not have these packages installed to your computer yet, you should follow instructions we’ve posted separately describing the required set-up for this exercise."
}
</script>

  

  


  


  





  <title>Exercise solution for Chapter 1 | CSU MSMB Group Study</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">CSU MSMB Group Study</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">CSU MSMB Group Study</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>People</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#experience"><span>Schedule</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Location</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/csu_msmb_syllabus.pdf"><span>Syllabus</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item">
        <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Exercise solution for Chapter 1</h1>

  

  
    


<div class="article-metadata">

  
  
  
  
  <div>
    



  
  <span><a href="/authors/brooke-anderson/">Brooke Anderson</a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Feb 11, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    10 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/exercises/">exercises</a>, <a href="/categories/chapter-1/">Chapter 1</a></span>
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      


<blockquote>
<p><strong>Exercise 1.8 (p. 17)</strong> Is the mitochondrial sequence of <em>C. elegans</em>
consistent with a model of equally likely nucleotides?</p>
</blockquote>
<p>This exercise asks us to explore the frequency of each of the four nucleotides
(A, C, G, and T) in the genome of <em>C. elegans</em>, a type of worm used frequently
in scientific research.</p>
<p>This solution requires that several R extension packages be loaded in your R
session. If you do not have these packages installed to your computer yet, you
should follow <a href="https://kind-neumann-789611.netlify.com/post/chapter-1-exercise-setup/">instructions we’ve posted
separately</a>
describing the required set-up for this exercise. Once you have installed these
packages on your computer, you can load them into your current R session using
the <code>library</code> function:</p>
<pre class="r"><code>library(&quot;BSgenome.Celegans.UCSC.ce2&quot;)
library(&quot;Biostrings&quot;)

library(&quot;tidyverse&quot;)
library(&quot;knitr&quot;)</code></pre>
<div id="part-a" class="section level2">
<h2>Part A</h2>
<blockquote>
<p>Explore the nucleotide frequencies of chromosome M by using a dedicated
function in the <em>Biostrings</em> package from Bioconductor.</p>
</blockquote>
<p>Part A of the question asks us to explore the nucleotide frequency of the <em>C.
elegans</em> genome. This genome is available in the <code>Celegans</code> data that comes with
the <code>BSgenome.Clegans.UCSC.ce2</code> package and is stored within a <code>BSgenome</code> class,
which is a special object class provided by the <code>Biostrings</code> package.</p>
<p>There is a dedicated function called <code>letterFrequency</code> in the <code>Biostrings</code>
package that can be used to count the frequency of letters in a string (like a
genome) in an R object like this. In a call to this function, you must also
include the possible letters in your “alphabet”—that is, the possible letters
that each position in your string could take.</p>
<pre class="r"><code>(nuc_freq &lt;- letterFrequency(Celegans$chrM, letters=c(&quot;A&quot;, &quot;C&quot;, &quot;G&quot;, &quot;T&quot;)))</code></pre>
<pre><code>##    A    C    G    T 
## 4335 1225 2055 6179</code></pre>
<p>To explore and plot this data, I put this summary data into a <code>tibble</code>, so I
could more easily use <code>tidyverse</code> tools with the data.</p>
<pre class="r"><code>nuc_freq_df &lt;- tibble(nucleotide = names(nuc_freq), 
             n = nuc_freq)
nuc_freq_df</code></pre>
<pre><code>## # A tibble: 4 x 2
##   nucleotide     n
##   &lt;chr&gt;      &lt;int&gt;
## 1 A           4335
## 2 C           1225
## 3 G           2055
## 4 T           6179</code></pre>
<p>In this format, you can use <code>tidyverse</code> tools to explore the data a bit more.
For example, you can determine the total number of nucleotides in the genome
and, with that calculate the proportion of each nucleotide across the genome.
Along with the <code>kable</code> function from the <code>knitr</code> package, I created a formatted
table with this information:</p>
<pre class="r"><code>nuc_freq_df %&gt;% 
  mutate(prop = n / sum(n)) %&gt;% 
  kable(digits = 2, 
        caption = &quot;Nucleotide frequencies and proportions in *C. elegans*&quot;,
        col.names = c(&quot;Nucleotide&quot;, &quot;Frequency&quot;, &quot;Proportion&quot;))</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-4">Table 1: </span>Nucleotide frequencies and proportions in <em>C. elegans</em></caption>
<thead>
<tr class="header">
<th align="left">Nucleotide</th>
<th align="right">Frequency</th>
<th align="right">Proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">4335</td>
<td align="right">0.31</td>
</tr>
<tr class="even">
<td align="left">C</td>
<td align="right">1225</td>
<td align="right">0.09</td>
</tr>
<tr class="odd">
<td align="left">G</td>
<td align="right">2055</td>
<td align="right">0.15</td>
</tr>
<tr class="even">
<td align="left">T</td>
<td align="right">6179</td>
<td align="right">0.45</td>
</tr>
</tbody>
</table>
<p>For some presentations, it might be clearer to present this information in a
slightly different table format, using <code>pivot_longer</code> and then <code>pivot_wider</code> to
reformat the table for presentation:</p>
<pre class="r"><code>nuc_freq_df %&gt;% 
  mutate(prop = n / sum(n),
         n = prettyNum(n, big.mark = &quot;,&quot;),
         prop = prettyNum(prop, digits = 2)) %&gt;% 
  pivot_longer(cols = c(&quot;n&quot;, &quot;prop&quot;)) %&gt;% 
  pivot_wider(names_from = &quot;nucleotide&quot;) %&gt;% 
  mutate(name = case_when(
    name == &quot;n&quot; ~ &quot;Frequency of nucleotide&quot;,
    name == &quot;prop&quot; ~ &quot;Proportion of all nucleotides&quot;
  )) %&gt;%  
  rename(` ` = name) %&gt;% 
  kable(align = c(&quot;rcccc&quot;), 
        caption = &quot;Nucleotide frequencies and proportions in *C. elegans*&quot;)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-5">Table 2: </span>Nucleotide frequencies and proportions in <em>C. elegans</em></caption>
<thead>
<tr class="header">
<th></th>
<th align="center">A</th>
<th align="center">C</th>
<th align="center">G</th>
<th align="center">T</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Frequency of nucleotide</td>
<td align="center">4,335</td>
<td align="center">1,225</td>
<td align="center">2,055</td>
<td align="center">6,179</td>
</tr>
<tr class="even">
<td>Proportion of all nucleotides</td>
<td align="center">0.31</td>
<td align="center">0.089</td>
<td align="center">0.15</td>
<td align="center">0.45</td>
</tr>
</tbody>
</table>
<p>Here is a plot of the frequency of each of the four nucleotides for the <em>C.
elegans</em> nucleotide:</p>
<pre class="r"><code>ggplot(nuc_freq_df, aes(x = nucleotide, y = n)) + 
  geom_col(fill = &quot;lavender&quot;, color = &quot;black&quot;) + 
  theme_classic() + 
  scale_y_continuous(label = scales::comma) + 
  theme(axis.title = element_blank()) + 
  labs(title = expression(paste(italic(&quot;C. elegans&quot;), &quot; neucleotide frequency&quot;)),
       caption = expression(paste(&quot;Based on data from the &quot;, italic(&quot;BSgenome.Celegans.UCSC.ce2&quot;), 
                                  &quot; package.&quot;)))</code></pre>
<p><img src="/post/2020-02-11-exercise-solution-for-chapter-1_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>This graph uses a few elements to improve its appearance that you might want to
explore if you’re not already familiar with them:</p>
<ul>
<li>The <code>labs</code> function is used to add both a title and a caption to the plot.</li>
<li>The <code>paste</code>, <code>expression</code>, and <code>italic</code> functions are used together to put “C.
elegans” and an R package name in italics in some of the labels on the plot.</li>
<li>The <code>scales</code> package is used inside a scale layer for the <code>ggplot2</code> code to
make the y-axis labels a bit nicer.</li>
<li><code>theme</code> calls are used to apply a simpler overall theme than the default and to
remove the x- and y-axis titles (with <code>element_blank</code>).</li>
<li>The color and fill of the bars are customized in the geom layer (<code>geom_col</code>).</li>
</ul>
<p>From this plot, it certainly looks like the nucleotides are <strong>not</strong> uniformly
distributed in the <em>C. elegans</em> genome. This question will be investigated more
in the next part of the exercise.</p>
</div>
<div id="part-b" class="section level2">
<h2>Part B</h2>
<blockquote>
<p>Test whether the <em>C. elegans</em> data are consistent with the uniform
model (all nucleotide frequencies the same) using a simulation.</p>
</blockquote>
<p>The second part of the exercise asks us to test whether the observed nucleotide
data for <em>C. elegans</em> is consistent with the uniform model that all nucleotide
frequencies are the same.</p>
<p>First, we can simulate several datasets under this null model and see how a plot
of nucleotide frequencies compares to the plot that we obtained with the observed
<em>C. elegans</em> data. To make these plots, I first simulated 20 samples under the
null model that the distribution is uniform across the four nucleotides, using
the <code>rmultinom</code> function with the <code>size</code> argument set to the number of nucleotides in
the original <em>C. elegans</em> genome data and the <code>prob</code> argument set to have an equal
probability of each nucleotide at each spot on the genome:</p>
<pre class="r"><code>(sim_nuc_freq &lt;- rmultinom(n = 20, 
                          size = sum(nuc_freq_df$n), 
                          prob = rep(1 / 4, 4)))</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
## [1,] 3505 3354 3451 3485 3474 3466 3503 3510 3368  3337  3409  3406  3554  3462
## [2,] 3360 3435 3438 3480 3369 3441 3405 3404 3498  3518  3500  3472  3370  3450
## [3,] 3400 3524 3394 3343 3478 3442 3425 3399 3502  3574  3534  3402  3411  3457
## [4,] 3529 3481 3511 3486 3473 3445 3461 3481 3426  3365  3351  3514  3459  3425
##      [,15] [,16] [,17] [,18] [,19] [,20]
## [1,]  3396  3601  3492  3456  3480  3391
## [2,]  3504  3452  3415  3434  3416  3467
## [3,]  3506  3435  3418  3456  3432  3421
## [4,]  3388  3306  3469  3448  3466  3515</code></pre>
<p>Next, I moved this into a tibble so I could more easily rearrange and plot the data using
facetting in <code>ggplot2</code>:</p>
<pre class="r"><code>sim_nuc_freq_df &lt;- as_tibble(sim_nuc_freq) %&gt;% 
  mutate(nucleotide = c(&quot;A&quot;, &quot;C&quot;, &quot;G&quot;, &quot;T&quot;)) %&gt;% 
  pivot_longer(-nucleotide, names_to = &quot;sample&quot;) %&gt;% 
  mutate(sample = sample %&gt;% str_remove(&quot;V&quot;) %&gt;% as.numeric()) %&gt;% 
  arrange(sample, nucleotide)

sim_nuc_freq_df %&gt;% 
  slice(1:10)</code></pre>
<pre><code>## # A tibble: 10 x 3
##    nucleotide sample value
##    &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;
##  1 A               1  3505
##  2 C               1  3360
##  3 G               1  3400
##  4 T               1  3529
##  5 A               2  3354
##  6 C               2  3435
##  7 G               2  3524
##  8 T               2  3481
##  9 A               3  3451
## 10 C               3  3438</code></pre>
<pre class="r"><code>ggplot(sim_nuc_freq_df, aes(x = nucleotide, y = value)) + 
  geom_col(fill = &quot;lavender&quot;, color = &quot;black&quot;) + 
  theme_classic() + 
  scale_y_continuous(label = scales::comma) + 
  theme(axis.title = element_blank()) + 
  labs(title = &quot;Simulated neucleotide frequencies under a uniform model&quot;) +
  facet_wrap(~ sample) + 
  expand_limits(y = max(nuc_freq_df$n))</code></pre>
<p><img src="/post/2020-02-11-exercise-solution-for-chapter-1_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>The y-axis limits were expanded here to cover the same range as that shown for the
observed <em>C. elegans</em> nucleotide frequencies, to help make it easier to compare these plots
with the plot of our observed data. These plots of data simulated under the null model do
show some variation in frequencies among the nucleotides, but it’s certainly much less than
in the observed data for <em>C. elegans</em>.</p>
<p>Next, I repeated this simulation process, but I increased the number of simulations to 1,000:</p>
<pre class="r"><code>sim_nuc_freq_df &lt;- rmultinom(n = 1000, 
                          size = sum(nuc_freq_df$n), 
                          prob = rep(1 / 4, 4)) %&gt;% 
  as_tibble() %&gt;% 
  mutate(nucleotide = c(&quot;A&quot;, &quot;C&quot;, &quot;G&quot;, &quot;T&quot;)) %&gt;% 
  pivot_longer(-nucleotide, names_to = &quot;sample&quot;) %&gt;% 
  mutate(sample = sample %&gt;% str_remove(&quot;V&quot;) %&gt;% as.numeric()) %&gt;% 
  arrange(sample, nucleotide)

sim_nuc_freq_df %&gt;% 
  slice(1:10)</code></pre>
<pre><code>## # A tibble: 10 x 3
##    nucleotide sample value
##    &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;
##  1 A               1  3387
##  2 C               1  3512
##  3 G               1  3461
##  4 T               1  3434
##  5 A               2  3522
##  6 C               2  3388
##  7 G               2  3432
##  8 T               2  3452
##  9 A               3  3549
## 10 C               3  3412</code></pre>
<p>Using this dataframe of simulations, we can measure the mean, minimum, and maximum frequencies
of each nucleotide across all 1,000 simulations:</p>
<pre class="r"><code>(sim_summary &lt;- sim_nuc_freq_df %&gt;% 
  group_by(nucleotide) %&gt;% 
  summarize(mean_freq = mean(value),
            min_freq = min(value), 
            max_freq = max(value)))</code></pre>
<pre><code>## # A tibble: 4 x 4
##   nucleotide mean_freq min_freq max_freq
##   &lt;chr&gt;          &lt;dbl&gt;    &lt;int&gt;    &lt;int&gt;
## 1 A              3450.     3296     3649
## 2 C              3443.     3270     3600
## 3 G              3454.     3272     3601
## 4 T              3447.     3290     3609</code></pre>
<p>To help compare this with the observed data, we can create a table with information from
both the original data and the simulations under the null model:</p>
<pre class="r"><code>nuc_freq_df %&gt;% 
  left_join(sim_summary, by = &quot;nucleotide&quot;) %&gt;% 
  mutate_at(c(&quot;mean_freq&quot;, &quot;min_freq&quot;, &quot;max_freq&quot;, &quot;n&quot;), 
            prettyNum, big.mark = &quot;,&quot;, digits = 0) %&gt;% 
  mutate(simulations = paste0(mean_freq, &quot; (&quot;, min_freq, &quot;, &quot;, max_freq, &quot;)&quot;)) %&gt;% 
  select(nucleotide, n, simulations) %&gt;% 
  kable(col.names = c(&quot;Nucleotide&quot;,              
        &quot;Frequency in C. elegans genome&quot;,
        &quot;Mean frequency (minimum frequency, maximum frequency) across 1,000 simulations&quot;), 
        align = &quot;c&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">Nucleotide</th>
<th align="center">Frequency in C. elegans genome</th>
<th align="center">Mean frequency (minimum frequency, maximum frequency) across 1,000 simulations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">A</td>
<td align="center">4,335</td>
<td align="center">3,450 (3,296, 3,649)</td>
</tr>
<tr class="even">
<td align="center">C</td>
<td align="center">1,225</td>
<td align="center">3,443 (3,270, 3,600)</td>
</tr>
<tr class="odd">
<td align="center">G</td>
<td align="center">2,055</td>
<td align="center">3,454 (3,272, 3,601)</td>
</tr>
<tr class="even">
<td align="center">T</td>
<td align="center">6,179</td>
<td align="center">3,447 (3,290, 3,609)</td>
</tr>
</tbody>
</table>
<p>This helps clarify how unusual the observed data would be under the null model—the
counts of all four nucleotides in the <em>C. elegans</em> genome are completely outside the
range of frequencies in the simulated data.</p>
<p>Another way to look at this is with histograms of the distribution of frequencies
of each nucleotide under the null model compared to the observed frequencies in
the <em>C. elegans</em> nucleotide:</p>
<pre class="r"><code>ggplot(sim_nuc_freq_df, aes(x = value)) + 
  geom_histogram(binwidth = 10) + 
  facet_wrap(~ nucleotide) + 
  theme_classic() + 
  scale_x_continuous(name = &quot;Frequency of nucleotide in the simulation under the null model&quot;,
                     labels = scales::comma) + 
  scale_y_continuous(name = &quot;# of simulations (out of 1,000)&quot;) + 
  geom_vline(data = nuc_freq_df, aes(xintercept = n), color = &quot;red&quot;) + 
  labs(title = expression(paste(&quot;Nucleotide frequency in &quot;,
                                italic(&quot;C. elegans&quot;), 
                                &quot; compared null model simulations&quot;)),
       caption = &quot;Red line shows the frequency observed for the nucleotide in C. elegans&quot;)</code></pre>
<p><img src="/post/2020-02-11-exercise-solution-for-chapter-1_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Finally, to help in answering this question, it would be interesting to look at a
single measure for each simulation (and for the observed data) rather than comparing
each nucleotide one at a time. Chapter 1 gives the equation for a statistic to
measure variability in multinomial data by calculating the sum of squares for the
differences between the observed and expected count of nucleotides for each of the
four nucleotides in a sample (p. 12).</p>
<p>I calculated this statistic for the observed data and then for each of the 1,000
simulations.</p>
<pre class="r"><code>(obs_stat &lt;- nuc_freq_df %&gt;% 
  mutate(expected = mean(n),
         stat_input = (n - expected) ^ 2 / expected) %&gt;% 
  summarize(variability_stat = sum(stat_input)))</code></pre>
<pre><code>## # A tibble: 1 x 1
##   variability_stat
##              &lt;dbl&gt;
## 1            4387.</code></pre>
<pre class="r"><code>sim_stat &lt;- sim_nuc_freq_df %&gt;% 
  mutate(expected = mean(value), 
         stat_input = (value - expected) ^ 2 / expected) %&gt;% 
  group_by(sample) %&gt;% 
  summarize(variability_stat = sum(stat_input))

sim_stat %&gt;% 
  slice(1:5)</code></pre>
<pre><code>## # A tibble: 5 x 2
##   sample variability_stat
##    &lt;dbl&gt;            &lt;dbl&gt;
## 1      1             2.37
## 2      2             2.71
## 3      3             3.95
## 4      4             9.27
## 5      5             4.01</code></pre>
<p>Here is a plot of the distribution of this statistic across the 1,000 simulations:</p>
<pre class="r"><code>ggplot(sim_stat, aes(x = variability_stat)) + 
  geom_rect(data = sim_stat, aes(xmin = quantile(variability_stat, prob = 0.025),
                                 xmax = quantile(variability_stat, prob = 0.975),
                                 ymin = 0, ymax = Inf), 
            fill = &quot;beige&quot;, alpha = 0.5) +
  geom_histogram(bins = 30, fill = &quot;white&quot;, color = &quot;tan&quot;, alpha = 0.5) +
  theme_classic() + 
  labs(title = &quot;Variability from expected values&quot;,
       subtitle = &quot;Values from simulations under the null&quot;,
       x = &quot;Value of variability statistic&quot;, 
       y = &quot;Number of simulations with given value&quot;,
       caption = &quot;The shaded yellow area shows the region of the central 95% of\nstatistic values for the 1,000 simulations under the null model.&quot;)</code></pre>
<p><img src="/post/2020-02-11-exercise-solution-for-chapter-1_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>The value of this statistic for the observed nucleotide frequencies for <em>C.
elegans</em> is 4387, which is much larger (indicating greater variability
from expected values under the null model) than the value observed under most of
the simulations. It is, in fact, far outside the central 95% range of values
observed in simulations.</p>
</div>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/exercises/">exercises</a>
  
  <a class="badge badge-light" href="/tags/chapter-1/">Chapter 1</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/exercise-solution-for-chapter-1/&amp;text=Exercise%20solution%20for%20Chapter%201" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/exercise-solution-for-chapter-1/&amp;t=Exercise%20solution%20for%20Chapter%201" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Exercise%20solution%20for%20Chapter%201&amp;body=/post/exercise-solution-for-chapter-1/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/exercise-solution-for-chapter-1/&amp;title=Exercise%20solution%20for%20Chapter%201" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Exercise%20solution%20for%20Chapter%201%20/post/exercise-solution-for-chapter-1/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/exercise-solution-for-chapter-1/&amp;title=Exercise%20solution%20for%20Chapter%201" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
  
    
  
  






  
  
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="avatar mr-3 avatar-circle" src="/authors/brooke-anderson/avatar_hu4742b8a6c216635453ea2ad39111ea72_19850_270x270_fill_q90_lanczos_center.jpg" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/authors/brooke-anderson/">Brooke Anderson</a></h5>
      <h6 class="card-subtitle">Assistant Professor of Epidemiology</h6>
      <p class="card-text">My research interests include environmental epidemiology, particularly on health impacts related to climate-related disasters, and R programming.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:brooke.anderson@colostate.edu" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/gbwanderson" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=CWSlbfsAAAAJ&amp;hl=en&amp;oi=ao" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/geanders" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>









  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/chapter-1-exercise-setup/">Chapter 1 exercise setup</a></li>
      
      <li><a href="/post/chapter-1-vocabulary-quiz/">Chapter 1 vocabulary quiz</a></li>
      
      <li><a href="/post/vocabulary-for-chapter-1/">Vocabulary for Chapter 1</a></li>
      
    </ul>
  </div>
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.3/mermaid.min.js" integrity="" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js" integrity="sha256-1zu+3BnLYV9LdiY85uXMzii3bdrkelyp37e0ZyTAQh0=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.a0d331bcd05dbe8b31e244f796710f08.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
